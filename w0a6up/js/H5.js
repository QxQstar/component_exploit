/* 内容管理对象 */
var H5 = function(){
	this.id = ("h5_" + Math.random()).replace(".","_");
	this.el = $("<div class='h5' id='"+ this.id +"'></div>").hide();
	$("body").append(this.el);
	this.page = [];
	this.addPage = function(name,text){
		var page = $("<div class='h5_page section'></div>");
		if(name != undefined){
			page.addClass("h5_page_"+ name);
		}
		if(text != undefined){
			page.text(text);
		}
		this.el.append(page);
		this.page.push(page);
        if(typeof  this.whenAddPage === 'function'){
            this.whenAddPage();
        }
		return this;
	};
	this.addComponent = function(name,cfg){
		var cfg = cfg || {};
		var component;
		var curPage = this.page.slice(-1)[0];
		//将cfg与{type:"base"}合并，如果cfg中有type属性将覆盖前面对象的type属性
		cfg = $.extend({
			type:"base"
		},cfg);
		switch(cfg.type){
			case "base":
				component = new H5ComponentBase(name,cfg);
				break;
            case "bar":
                component = new H5ComponentBar(name,cfg);
                break;
            case "bar_v":
                component = new H5ComponentBar_v(name,cfg);
                break;
            case "radar":
                component = new H5ComponentRadar(name,cfg);
                break;
            case "polyline":
                component = new H5ComponentPolyline(name,cfg);
                break;
            case "ring":
                component = new H5ComponentRing(name,cfg);
                break;
            case "point":
                component = new H5ComponentPoint(name,cfg);
                break;
            case "pie":
                component = new H5ComponentPie(name,cfg);
                break;
			default :
		}
		curPage.append(component);
		return this;
	};

	this.loader = function(images){
        this.loader = typeof H5_loading == 'function' ? H5_loading : this.loader;
		this.el.fullpage({
			onLeave:function(index,nextIndex,dri){
				$(this).find('.h5_Component').trigger("onLeave");
			},
			afterLoad:function(anchorIndex,index){
				$(this).find('.h5_Component').trigger('onLoad');
			}
		});
		this.el.find(".h5_page").eq(0).find(".h5_Component").trigger("onLoad");
		this.el.show();

	};
	return this;
};
